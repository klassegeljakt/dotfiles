# Prefix key
unbind C-b
set -g prefix C-w
bind C-w send-prefix
# Options
set -sg escape-time 0 # helps in faster key repetition
set -g base-index 1
set -g pane-base-index 1
set -g default-terminal "screen-256color"
set -g mode-keys vi
# Keybinds
bind T swap-window -t 1
bind r source-file ~/.tmux.conf \; display "Configuration Reloaded!"
bind P pipe-pane -o "cat >>~/#W.log" \; display "Toggled logging to ~/#W.log"
# Vim window switching
bind k select-pane -U
bind j select-pane -D
bind h select-pane -L
bind l select-pane -R
bind P previous-window
bind & kill-window
bind x kill-pane
# Tmux + Vim = <3
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

bind h if-shell "$is_vim" "send-keys C-w h" "select-pane -L"
bind j if-shell "$is_vim" "send-keys C-w j" "select-pane -D"
bind k if-shell "$is_vim" "send-keys C-w k" "select-pane -U"
bind l if-shell "$is_vim" "send-keys C-w l" "select-pane -R"
bind s if-shell "$is_vim" "send-keys C-w s" "split-window -v -c \"#{pane_current_path}\""
bind v if-shell "$is_vim" "send-keys C-w v" "split-window -h -c \"#{pane_current_path}\""
bind x if-shell "$is_vim" "send-keys C-w x" "kill-pane"
bind x if-shell "$is_vim" "send-keys C-w x" "kill-pane"
bind -n C-v if-shell "$is_vim" "send-keys C-v" "copy-mode"
bind S split-window -v
bind V split-window -h
#bind -n å if-shell "$is_vim" "send-keys C-w w" "next-window"
bind -n å select-pane -t :.+
# Copying
unbind [
unbind p
bind p paste-buffer
#bind -n ö copy-mode
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-selection
# Resize panes with <Alt-+> and <Alt-Shift-+>
bind -n ± resize-pane -D
bind -n ¿ resize-pane -U
bind -n ≤ resize-pane -L
bind -n ≥ resize-pane -R
#bind -n ÷ if-shell "$is_vim" "send-keys C-w ±"
#bind -n ⁄ if-shell "$is_vim" "send-keys C-w ¿"
#bind -n ≈ if-shell "$is_vim" "send-keys C-w ≤"
#bind -n ≠ if-shell "$is_vim" "send-keys C-w ≥"

bind q choose-tree
# Colors
set -g status-right-length 100
set-environment -g TMUX_PLUGIN_MANAGER_PATH '~/.tmux/plugins/'
set -g status-justify "left"
set -g status "on"
set -g status-attr "none"
set -g message-command-bg "colour31"
set -g status-left-length "100"
#set -g pane-active-border-fg "colour254"
set -g status-bg "colour238"
set -g message-command-fg "colour231"
set -g pane-border-fg "colour240"
set -g pane-active-border-fg "colour240"
set -g message-bg "colour31"
set -g status-left-attr "none"
set -g status-right-attr "none"
set -g status-right-length "100"
set -g message-fg "colour231"
setw -g window-status-fg "colour250"
setw -g window-status-attr "none"
setw -g window-status-activity-bg "colour238"
setw -g window-status-activity-attr "none"
setw -g window-status-activity-fg "colour250"
setw -g window-status-separator ""
setw -g window-status-bg "colour238"
set -g status-left ""
set -g status-right "#[fg=colour11,bg=colour238,bold] #[fg=colour247,bg=colour238,bright](#(cd #{pane_current_path}; git rev-parse --abbrev-ref HEAD)) #[fg=colour240,bg=colour238,bold]#[fg=colour240,bg=colour238,bold]#[fg=colour247,bg=colour240] %F  %R #[fg=colour244,bg=colour240,bold]#[fg=colour11,bg=colour244,bright,bold]  #[fg=colour238,bg=colour244]#(ifconfig en0 | grep 'inet ' | awk '{print $2}')  #[fg=colour11,bg=colour244,bold] #[fg=colour238,bg=colour244,bold]#(curl icanhazip.com) "
setw -g window-status-format " #[fg=colour240,bg=colour238,bold]#[fg=colour247,bg=colour240,bold]#I:#W#[fg=colour240,bg=colour238,bold]"
setw -g window-status-current-format " #[fg=colour247,bg=colour238]#[fg=colour238,bg=colour247]#I:#W#[fg=colour247,bg=colour238]"
set-option -g status-position top # Status bar at top

# New window with default path set to last path
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

set-option -g history-limit 1000 # Limit scrollback
## List of plugins
#set-environment -g TMUX_PLUGIN_MANAGER_PATH "/Users/Klas/.tmux/plugins"
#set -g @plugin 'tmux-plugins/tpm'
##set -g @plugin 'tmux-plugins/tmux-net-speed'
#set -g @plugin 'tmux-plugins/tmux-sensible'
##set -g @plugin 'tmux-plugins/tpm'
##set -g @plugin 'tmux-plugins/tmux-sensible'
##set -g @plugin 'tmux-plugins/tmux-copycat'
##
### Initialize TMUX plugin manager (Keep this line at the bottom)
#run '~/.tmux/plugins/tpm/tpm'

# List of plugins
#set -g @plugin 'tmux-plugins/tpm'
#set -g @plugin 'tmux-plugins/tmux-sensible'
#
#run '~/.tmux/plugins/tpm/tpm'
#source ~/Git/github/tmux-fzf-url/fzf-url.tmux

#set -g status-right "#[fg=colour124,bg=colour238,bold] #[fg=colour247,bg=colour238,bold](#(git branch | grep -e "^*" | cut -d' ' -f 2)) #[fg=colour240,bg=colour238,bold]#[fg=colour247,bg=colour240] %Y-%m-%d  x#($(ansiweather -l stockholm -u metric -a false -s true -w false -h false -p false -d false | awk '{print $2}'))x #[fg=colour244,bg=colour240,bold]#[fg=colour19,bg=colour244] 直#[fg=colour238,bg=colour244]#(ifconfig en0 | grep 'inet ' | awk '{print $2}')  #[fg=colour23,bg=colour244]  #[fg=colour238,bg=colour244]#(curl icanhazip.com)"
#set -g status-right "#[fg=colour124,bg=colour238,bold] #[fg=colour247,bg=colour238,bold](#(git branch | grep -e "^*" | cut -d' ' -f 2)) #[fg=colour240,bg=colour238,bold]#[fg=colour247,bg=colour240] %Y-%m-%d  #(ansiweather -l stockholm -u metric -a false -s true -w false -h false -p false -d false | awk -F\" \" '{ print $7\" \" $5 $6}') #[fg=colour244,bg=colour240,bold]#[fg=colour19,bg=colour244] 直#[fg=colour238,bg=colour244]#(ifconfig en0 | grep 'inet ' | awk '{print $2}')  #[fg=colour23,bg=colour244]  #[fg=colour238,bg=colour244]#(curl icanhazip.com)"
